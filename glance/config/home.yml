- name: Home
  # Optionally, if you only have a single page you can hide the desktop navigation for a cleaner look
  # hide-desktop-navigation: true
  columns:
    - size: small
      widgets:
        - type: calendar
          first-day-of-week: monday

        - type: rss
          limit: 10
          collapse-after: 3
          cache: 12h
          feeds:
            - url: https://selfh.st/rss/
              title: selfh.st
            - url: https://ciechanow.ski/atom.xml
            - url: https://www.joshwcomeau.com/rss.xml
              title: Josh Comeau
            - url: https://samwho.dev/rss.xml
            - url: https://ishadeed.com/feed.xml
              title: Ahmad Shadeed

        - type: custom-api
          title: "Jellyfin Stats"
          base-url: ${JELLYFIN_URL}
          options:
            url: ${JELLYFIN_URL}
            key: ${JELLYFIN_API_KEY}

          template: |
            {{ $url := .Options.StringOr "url" "" }}
            {{ $key := .Options.StringOr "key" "" }}
            {{- if or (eq $url "") (eq $key "") -}}
              <p>Error: The URL or API Key was not configured in the widget options.</p>
            {{- else -}}
              {{- $requestUrl := printf "%s/emby/Items/Counts?api_key=%s" $url $key -}}
              {{- $jellyfinData := newRequest $requestUrl | getResponse -}}
              {{- if eq $jellyfinData.Response.StatusCode 200 -}}
                <div class="flex flex-column gap-5">
                  <div class="flex justify-between text-center">
                    <div>
                      <div class="color-highlight size-h3">{{ $jellyfinData.JSON.Int "MovieCount" | formatNumber }}</div>
                      <div class="size-h5 uppercase">Movies</div>
                    </div>
                    <div>
                      <div class="color-highlight size-h3">{{ $jellyfinData.JSON.Int "SeriesCount" | formatNumber }}</div>
                      <div class="size-h5 uppercase">TV Shows</div>
                    </div>
                    <div>
                      <div class="color-highlight size-h3">{{ $jellyfinData.JSON.Int "EpisodeCount" | formatNumber }}</div>
                      <div class="size-h5 uppercase">Episodes</div>
                    </div>
                    <div>
                      <div class="color-highlight size-h3">{{ $jellyfinData.JSON.Int "SongCount" | formatNumber }}</div>
                      <div class="size-h5 uppercase">Songs</div>
                    </div>
                  </div>
                </div>
              {{- else -}}
                <p>Failed: {{ $jellyfinData.Response.Status }}</p>
              {{- end -}}
            {{- end -}}

    - size: full
      widgets:
        - type: group
          widgets:
            - type: hacker-news
            - type: lobsters

        - type: videos
          channels:
            - UCXuqSBlHAE6Xw-yeJA0Tunw # Linus Tech Tips
            - UCR-DXc1voovS8nhAvccRZhg # Jeff Geerling
            - UCsBjURrPoezykLs9EqgamOA # Fireship
            - UCBJycsmduvYEL83R_U4JriQ # Marques Brownlee
            - UCHnyfMqiRRG1u-2MsSQLbXA # Veritasium

        - type: group
          widgets:
            - type: reddit
              subreddit: technology
              show-thumbnails: true
            - type: reddit
              subreddit: selfhosted
              show-thumbnails: true

    - size: small
      widgets:
        - type: weather
          location: Germany
          units: metric # alternatively "imperial"
          hour-format: 24h # alternatively "24h"
          # Optionally hide the location from being displayed in the widget
          # hide-location: true

        - type: markets
          markets:
            - symbol: SPY
              name: S&P 500
            - symbol: BTC-USD
              name: Bitcoin
            - symbol: NVDA
              name: NVIDIA
            - symbol: AAPL
              name: Apple
            - symbol: MSFT
              name: Microsoft

        - type: custom-api
          title: Astronomy Picture of the Day
          cache: 1d
          url: https://api.nasa.gov/planetary/apod?api_key=${NASA_API_KEY}
          headers:
            Accept: application/json
          template: |
              {{- if eq (.JSON.String "media_type") "image" -}}
                <div style="display:flex; flex-direction:column; align-items:center; width:100%; padding:8px; box-sizing:border-box;">
                  <!-- Clickable title -->
                  <p class="color-primary" style="margin:0 0 8px; text-align:center;">
                    <a
                      href="https://apod.nasa.gov/apod/astropix.html"
                      target="_blank"
                      rel="noopener noreferrer"
                      style="color: inherit; text-decoration: none;"
                    >
                      {{ .JSON.String "title" }}
                    </a>
                  </p>
                  <!-- Image -->
                  <img
                    src="{{ .JSON.String "url" }}"
                    alt="{{ .JSON.String "title" }}"
                    style="max-width:100%; height:auto; display:block; border-radius:4px;"
                  />
                  <!-- Explanation dropdown -->
                  <details style="width:100%; margin-top:12px;">
                    <summary class="color-highlight size-h5" style="cursor:pointer;">
                      Show Explanation
                    </summary>
                    <p class="color-highlight size-h5" style="margin-top:8px; text-align:left; line-height:1.4;">
                      {{ .JSON.String "explanation" }}
                    </p>
                  </details>
                </div>
              {{- else -}}
                <p class="color-negative" style="text-align:center;">
                  No image available today.
                </p>
              {{- end }}
